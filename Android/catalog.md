android å­¦ä¹ æ€»ç»“

### 1 å†…å­˜æ³„éœ²çš„åœºæ™¯æœ‰å“ªäº›ï¼Ÿå†…å­˜åˆ†æå·¥å…·çš„ä½¿ç”¨æ–¹æ³•ï¼Ÿ
- å•ä¾‹æ¨¡å¼å¼•èµ·çš„å†…å­˜æ³„éœ²
- é™æ€å˜é‡å¯¼è‡´çš„å†…å­˜æ³„éœ²
- éé™æ€å†…éƒ¨ç±»å¼•èµ·çš„å†…å­˜æ³„éœ²
- ä½¿ç”¨èµ„æºæ—¶ï¼ŒæœªåŠæ—¶å…³é—­å¼•èµ·æ³„éœ²
- webviewå¯¼è‡´çš„å†…å­˜æ³„éœ²


å¯¹äºå†…å­˜æ³„éœ²çš„æ£€æµ‹ï¼Œå¸¸ç”¨å·¥å…·æœ‰LeakCanaryã€MATã€ASè‡ªå¸¦çš„Profilerã€‚

### 2 å¯åŠ¨ä¼˜åŒ–ï¼Œæœ‰ä»€ä¹ˆå·¥å…·å¯ä»¥ä½¿ç”¨ï¼Ÿ

é‡ç‚¹å°±æ˜¯systraceå·¥å…·çš„ä½¿ç”¨ã€‚


### 3 Handler,looper,messagequeue,thread,message,æ¯ä¸ªç±»åŠŸèƒ½,å…³ç³»ï¼Ÿ

èƒŒæ™¯ï¼šä»å¤šä»»åŠ¡æ‰§è¡Œæœºåˆ¶ä¸Šæ¥è¯´ï¼Œæœ‰3ç§æ–¹å¼(æ’é˜Ÿï¼Œå¤šçº¿ç¨‹ï¼Œforkè¿›ç¨‹)ï¼ŒHandler æ˜¯ç¬¬ä¸€ç§ï¼Œè‘—åçš„ä½¿ç”¨æ¡ˆä¾‹æœ‰ IOS-runLooper 
NodeJs-eventLooper æ’é˜Ÿæ‰§è¡Œä»»åŠ¡ (message) å°±æœ‰å¯¹åº”çš„ messagequeue é˜Ÿåˆ—ï¼Œè´Ÿè´£ å­˜ enqueueMessage() å– next().å¯¹äºandroidç³»ç»Ÿæ¥è¯´ï¼Œæˆ‘ä»¬çŸ¥é“æ•´ä¸ªæ¶ˆæ¯æœºåˆ¶ç”¨çš„æ˜¯ Handlerï¼Œç‚¹å‡»å›¾æ ‡è¿›ç¨‹è¢«forkèµ·æ¥ï¼ŒAMSä¼šé€šè¿‡ startProcessLocked å‡½æ•°é€šè¿‡ socket è¿æ¥ zygot è°ƒç”¨ RuntimetInit.zygotInit -> invokeStaticMain åå°„è°ƒç”¨android.app.ActivityThread çš„ mainæ–¹æ³•ï¼Œåˆå§‹åŒ– Looperï¼Œattach æ—¶å€™é€šè¿‡ Handler+AMS çš„ä»£ç†åˆå§‹åŒ– application. æ—¢ç„¶æˆ‘ä»¬çš„appå¯ä»¥ä¸€ç›´æ­£å¸¸å·¥ä½œï¼Œé‚£ä¹ˆå°±éœ€è¦è¿™æ ·ä¸€ä¸ªè§’è‰² Looper.loop() ä¸€ä¸ªforå¾ªç¯ å½“ç„¶èŠ‚çœèµ„æºæ¥è¯´ï¼Œæ²¡æœ‰ä»»åŠ¡å¤„ç†æ—¶å°±ä¼šé€šè¿‡ MessageQueue çš„ mPtr ç®¡é“ï¼Œå»ä½¿ç”¨linux çš„ expoll å»é˜»å¡ï¼Œæœ‰ä»»åŠ¡æ—¶å†å» nativeWake

-------> Handler æºç åˆ†æ ğŸ‘‡
